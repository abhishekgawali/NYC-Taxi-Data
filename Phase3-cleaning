select * from greencab g ;


select * from yellowcab y 


select * from lvhiretaxi l ;




select * from greencab g 


-----------------------Extracting of date and time for pickp------------------------------

select extract(seconds from tpep_pickup_datetime::timestamp)  as ti from yellowcab y ;


alter table greencab 
add column lpep_pickup_time_minutes int




alter table greencab 
add column lpep_pickup_time_hour int





update greencab 
set lpep_pickup_time_minutes=extract(minute from lpep_pickup_datetime::timestamp)




update greencab 
set lpep_pickup_time_hour=extract(hour from lpep_pickup_datetime::timestamp)




--------Extractinf Date time for pickp Date----------------------------------------



alter table greencab 

add column lpep_dropoff_datetime_val date;


alter table greencab 

add column lpep_dropoff_minute int;




alter table greencab 

add column lpep_dropoff_hour int;




select * from greencab g ;


update greencab 
set lpep_dropoff_datetime_val=lpep_dropoff_datetime::date



update greencab 
set lpep_dropoff_minute=extract(minute from lpep_dropoff_datetime::timestamp)






update greencab 
set lpep_dropoff_hour=extract(hour from lpep_dropoff_datetime::timestamp)





select * from greencab g ;



-------------------------------------------------Integration---------------------------------------------------------------------



create materialized view manhattan_view as

select
greencab.vendorid,greencab.lpep_pickup_datetime,greencab.lpep_dropoff_datetime,
greencab.ratecodeid,greencab.pulocationid,greencab.dolocationid,
greencab.passenger_count,greencab.trip_distance,greencab.fare_amount,
greencab.extra,greencab.mta_tax,greencab.tip_amount,greencab.tolls_amount,
greencab.ehail_fee,greencab.improvement_surcharge,greencab.total_amount,greencab.payment_type,
greencab.congestion_surcharge

from greencab as greencab
join locationlookup l 
on l.locationid= greencab.pulocationid
and l.borough ='"Manhattan"'











create materialized view queens_view as

select
greencab.vendorid,greencab.lpep_pickup_datetime,greencab.lpep_dropoff_datetime,
greencab.ratecodeid,greencab.pulocationid,greencab.dolocationid,
greencab.passenger_count,greencab.trip_distance,greencab.fare_amount,
greencab.extra,greencab.mta_tax,greencab.tip_amount,greencab.tolls_amount,
greencab.ehail_fee,greencab.improvement_surcharge,greencab.total_amount,greencab.payment_type,
greencab.congestion_surcharge

from greencab as greencab
join locationlookup l 
on l.locationid= greencab.pulocationid
and l.borough ='"Queens"'




create materialized view bronx_view as

select
greencab.vendorid,greencab.lpep_pickup_datetime,greencab.lpep_dropoff_datetime,
greencab.ratecodeid,greencab.pulocationid,greencab.dolocationid,
greencab.passenger_count,greencab.trip_distance,greencab.fare_amount,
greencab.extra,greencab.mta_tax,greencab.tip_amount,greencab.tolls_amount,
greencab.ehail_fee,greencab.improvement_surcharge,greencab.total_amount,greencab.payment_type,
greencab.congestion_surcharge

from greencab as greencab
join locationlookup l 
on l.locationid= greencab.pulocationid
and l.borough ='"Bronx"'



create materialized view brooklyn_view as

select
greencab.vendorid,greencab.lpep_pickup_datetime,greencab.lpep_dropoff_datetime,
greencab.ratecodeid,greencab.pulocationid,greencab.dolocationid,
greencab.passenger_count,greencab.trip_distance,greencab.fare_amount,
greencab.extra,greencab.mta_tax,greencab.tip_amount,greencab.tolls_amount,
greencab.ehail_fee,greencab.improvement_surcharge,greencab.total_amount,greencab.payment_type,
greencab.congestion_surcharge

from greencab as greencab
join locationlookup l 
on l.locationid= greencab.pulocationid
and l.borough ='"Brooklyn"'




create materialized view ewr_view as

select
greencab.vendorid,greencab.lpep_pickup_datetime,greencab.lpep_dropoff_datetime,
greencab.ratecodeid,greencab.pulocationid,greencab.dolocationid,
greencab.passenger_count,greencab.trip_distance,greencab.fare_amount,
greencab.extra,greencab.mta_tax,greencab.tip_amount,greencab.tolls_amount,
greencab.ehail_fee,greencab.improvement_surcharge,greencab.total_amount,greencab.payment_type,
greencab.congestion_surcharge

from greencab as greencab
join locationlookup l 
on l.locationid= greencab.pulocationid
and l.borough ='"EWR"'





create materialized view staten_view as

select
greencab.vendorid,greencab.lpep_pickup_datetime,greencab.lpep_dropoff_datetime,
greencab.ratecodeid,greencab.pulocationid,greencab.dolocationid,
greencab.passenger_count,greencab.trip_distance,greencab.fare_amount,
greencab.extra,greencab.mta_tax,greencab.tip_amount,greencab.tolls_amount,
greencab.ehail_fee,greencab.improvement_surcharge,greencab.total_amount,greencab.payment_type,
greencab.congestion_surcharge

from greencab as greencab
join locationlookup l 
on l.locationid= greencab.pulocationid
and l.borough ='"Staten Island"'






create materialized view unknown_view as

select
greencab.vendorid,greencab.lpep_pickup_datetime,greencab.lpep_dropoff_datetime,
greencab.ratecodeid,greencab.pulocationid,greencab.dolocationid,
greencab.passenger_count,greencab.trip_distance,greencab.fare_amount,
greencab.extra,greencab.mta_tax,greencab.tip_amount,greencab.tolls_amount,
greencab.ehail_fee,greencab.improvement_surcharge,greencab.total_amount,greencab.payment_type,
greencab.congestion_surcharge

from greencab as greencab
join locationlookup l 
on l.locationid= greencab.pulocationid
and l.borough ='"Unknown"'







